Iterations
==========

Iteration 1
-----------

A single Civilization is instantiated at year zero with a random
number of people, and an initial fertility and mortality rate. Over
the course of 100 years, the population increases/decreases by those
rates, and outputs the population for that year to the screen.

Iteration 2
-----------

A random famine event causes a large, single year spike in deaths.
Such an event, and the resultant death count, is output to the screen.

Iteration 3
-----------

A ruler character is created at instantiation (just a number). They
start at 21 years old and age until they die of old age (randomly
determined by actuarial table).

Iteration 4
-----------

The ruler character can get married and have children.

Iteration 5
-----------

Characters are given first names using a rudimentary name creator.

Iteration 6
-----------

Characters should have family names. When two characters get married,
it's random which one gets put into the others family, unless one of
the characters has no family name (indicating they are commoners.)
Children inherit the family name of their parents.

Iteration 7
-----------

A character becoming the ruler of a civ is an event.

Iteration 8
-----------

Rulers are suceeded by their first living child.

Iteration 9
-----------

Children are most likely to be named based on their parents or
grandparents.

Iteration 10
------------

Better succession: English rules, walk the tree. There's still a bug
in this, needs improvement.

Iteration 11 - Houses
---------------------
Finished 2026-01-11

When a civilization is created, 3-5 elite houses are created. Each
house has a head, which starts with the founder and is inherited on
death. One of the houses becomes the ruling family of the civ, and the
current head of the house becomes the ruler. When a ruler dies and
there are no suitable candidates from the house to succeed them, a
random other house is selected to be the ruling house, and their
current head becomes the ruler.

The civ founding message looks like this:

> The civilization [name] emerged in year [year]. It numbered [pop]
> people. The civilization was ruled by house [ruling house name]. The
> houses of [other house names] were also prominent at this time.

When elites get married they prefer to marry someone in another elite
family, only marrying a commoner if there are no available candidates.

Iteration 12 - settlements
--------------------------

- Tie together settlements and civilisations
- Managers make distribution of surplus in deficit years more effective

A civilization starts with a single named settlement, with a tracked
population. The larger the population of the settlement, the more food
it needs. The settlement has a percentage of the population focused on
agricultural production, and, based on the agricultural efficiency, a
certain amount of food is produced. The agricultural efficiency is the
ratio of how much an individual can produce to how much an individual
requires. An efficiency of 1 means they can produce enough to feed
themselves (subsistance farming). Above 1 means a surplus is produced.
Below 1 means you're in trouble.

The surplus produced is stored, and the stored surplus can be used
during years of deficit to prevent the starvation of the populace.

The larger the population gets, and therefore the larger the surplus
gets in absolute terms, the harder it is to collect. Without
administrators dedicated to the collection of the surplus, a very
large amount of it will go uncollected.

The effect of this penalty is mitigated by a managerial class: the
more managers a settlement has, the more the penalty is reduced. This
decreases the proportion of the settlement that is actually farming,
but will result in a larger surplus production as settlements grow,
because the storage penalties scale faster than the actual surplus
production.

In short
--------

- Degradation of accumulated surplus
- Nomad raiders require development of protection in the form of walls and militias
- Civilization has settlements with individual populations
- Family trees for characters, marriage, children
- Religions and priestly casts
- Multiple civilizations
- Written histories
- Emergant elites from military
- Characters have attributes: intelligence, physical, charisma, military, tall, short, obese, skinny, righteous, loyal
- Name generation should be done based on standard phoenetic symbols, not on latin letters. Then, translate them to latin letters (or another literation system)
- Longer term: Given names should be tracked at the civ level, and change in popularity over time.
- Better house creation: a founder member is generated between 50 and 100 years before the founding, and the family tree run forward to the civ founding year.
- UI: browser for civs, events, family trees.

Small Changes, refactors
------------------------

- Different birth / death rates for males and females.
- Adjust birth / death rates to be more like medieval europe
- From above, check that population doesn't explode too badly

Surplus function is not good. If x = produced and y = collected, y
should be pretty much equal to x for small x. Then the penalty should
progressively increase as x increases, until it asymptotically
approaches y=Y_MAX.

P = total population

x = food produced
f = proportion of population dedicated to farming
n = agricultural productivity: the amount of food (in fed-person units) a single farmer can produce

y = amount collected

CAP_0 = 1000 : the maximum amount of food that can be collected without any dedicated collection infrastructure.
a = admin effectiveness. The additional amount of food that can be collected by each manager
m = proportion of population dedicated to management/collection
M = mP: the amount of managers in absolute terms

capM = cap(M) = aM+CAP_0 : The actual maximum amount of food that can be collected

x = Pfe

Y = amP+B
x = fnP
y = Y*(1-e^(-x/Y))
y = (amP+B)*(1-e^(-fnP/(amP+B)))

y = (amx+B)*(1-e^(-fnx/(amx+B)))

y = (amx+B)*(1-e^(-fnx/(amx+B)))

$$
y=\left(amx+1000\right)\ \left(1-e^{\frac{-fnx}{amx+1000}}\right)
$$

Stick a 3 in there, bit of the fudge. Means production will start to
decrease at around m=0.2, which feels about right

y = (Amx+B)*(1-e^(-Nfx/(3Amx+B)))

A = 5
N = 1.1
B = 1000
